<!doctype html>
<html lang="es">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>Agendar Cita — DentalStar</title>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="css/styles.css">
</head>
<body>
	<!-- Site header: brand and main navigation -->
	<header class="site-header" role="banner">
		<div class="container nav-container">
			<div class="brand">
				<!-- Logo: use DentalStar asset for consistent branding -->
				<img src="assets/logo-dentalstar.png" alt="DentalStar logo" class="logo">
				<span class="brand-name">DentalStar</span>
			</div>
			<nav class="main-nav" role="navigation" aria-label="Navegación principal">
				<ul>
					<li><a href="index.html" class="nav-link">Home</a></li>
					<li><a href="book.html" class="nav-link active">Agendar Citas</a></li>
					<li><a href="admin.html" id="adminNavLink" class="nav-link">Gestionar Citas</a></li>
				</ul>
			</nav>
			<div class="nav-actions">
				<button class="btn btn-outline" id="loginTopBtn">Login</button>
				<button class="nav-toggle" aria-label="Abrir menú" aria-expanded="false" aria-controls="main-nav">☰</button>
			</div>
		</div>
	</header>

	<main class="container" style="padding:28px 20px">
		<h2>Agendar cita</h2>
		<p class="muted">Completa tus datos y elige el servicio, fecha y hora.</p>

		<form id="bookingForm" class="form-card">
			<div class="form-field">
				<label for="patient_name">Nombre completo</label>
				<input id="patient_name" name="patient_name" type="text" required class="form-input" placeholder="Ej: María Pérez" />
				<div class="field-help">Escribe tu nombre y apellidos completos.</div>
			</div>

			<div class="form-field">
				<label for="patient_email">Email</label>
				<input id="patient_email" name="patient_email" type="email" class="form-input" placeholder="Ej: nombre@ejemplo.com" />
				<div class="field-help">Usaremos este correo para enviarte la confirmación.</div>
			</div>

			<div class="form-field">
				<label for="patient_phone">Teléfono</label>
				<input id="patient_phone" name="patient_phone" type="tel" class="form-input" placeholder="Ej: 0424-7758482" />
				<div class="field-help">Incluye código de área si aplica.</div>
			</div>

			<div class="form-field">
				<label for="service_id">Servicio</label>
				<select id="service_id" name="service_id" required class="form-select">
					<option value="">Cargando servicios…</option>
				</select>
				<div class="field-help">Selecciona el procedimiento que necesitas.</div>
			</div>

			<!-- Resumen de precio -->
			<div id="priceSummary" class="price-summary" style="display:none">
				<div id="priceLine" class="price-line">Precio: <span id="priceVal">$0.00</span></div>
				<div id="vatLine" class="muted">IVA (12%): <span id="vatVal">$0.00</span></div>
				<div id="totalLine" style="margin-top:6px">Total: <strong id="totalVal">$0.00</strong></div>
			</div>

			<div style="display:flex;gap:12px;flex-wrap:wrap">
				<div style="flex:1;min-width:180px">
					<label for="appointment_date">Fecha</label>
					<input id="appointment_date" name="appointment_date" type="date" required class="form-input">
					<div class="field-help">La fecha debe ser posterior al día actual.</div>
				</div>
				<div style="width:160px;min-width:120px">
					<label for="appointment_time">Hora</label>
					<!-- Selección simple: el usuario elige un número entre 6 y 12. JS convertirá a HH:00 al enviar -->
					<select id="appointment_time" name="appointment_time" required class="form-select">
						<option value="">Hora</option>
						<option value="6">6 AM</option>
						<option value="7">7 AM</option>
						<option value="8">8 AM</option>
						<option value="9">9 AM</option>
						<option value="10">10 AM</option>
						<option value="11">11 AM</option>
						<option value="12">12 PM</option>
					</select>
					<div class="field-help">Selecciona la hora exacta (ej: 9 AM).</div>
				</div>
			</div>

			<div class="form-actions">
				<button type="submit" class="btn btn-primary">Agendar</button>
			</div>

			<div id="formMessage" style="margin-top:12px"></div>
		</form>
	</main>

	<footer class="site-footer">
		<div class="container footer-inner">
			<div>© <strong>DentalStar</strong> — Todos los derechos reservados</div>
		</div>
	</footer>

	<!-- Scripts: Supabase client, auth UI and booking logic -->
	<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/bundle.min.js"></script>
	<script src="js/supabaseClient.js"></script>
	<script src="js/auth-ui.js"></script>
	<script src="js/book.js" defer></script>

	<script>
		const btn = document.querySelector('.nav-toggle');
		const nav = document.querySelector('.main-nav ul');
		btn.addEventListener('click', () => {
			const expanded = btn.getAttribute('aria-expanded') === 'true';
			btn.setAttribute('aria-expanded', (!expanded).toString());
			nav.classList.toggle('open');
		});
	</script>
</body>
</html>
